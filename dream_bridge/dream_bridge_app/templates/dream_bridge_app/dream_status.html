{% extends "dream_bridge_app/base.html" %}


{% block title %}Statut de votre rÃªve - Dream Bridge{% endblock %}

<!-- 
{% load static %}
{% block styles %}
<link rel="stylesheet" href="{% static 'dream_bridge_app/waiting_screen.css' %}">
{% endblock %} -->


{% block content %}
<div class="parallax-bg"></div>

<main class="main-content depth-layer"> 
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 col-md-10">

                <div id="loading-screen" class="glass-card" 
                     data-check-url="{% url 'dream_bridge_app:check-dream-status-api' dream_id=dream.id %}"
                     data-status="{{ dream.status }}">

                    <div class="mystic-loader">
                      <div class="moon"></div>
                      <div class="star"></div>
                      <div class="star twinkle"></div>
                      <div class="star"></div>
                    </div>

                    <h3 class="waiting-title">Les astres interprÃ¨tent votre rÃªveâ€¦</h3>
                    <p id="loading-message">
                      Nos algorithmes percent le mystÃ¨re de votre subconscientâ€¦
                    </p>

                    <!-- Message du jour stylisÃ© -->
                    <div class="astro-message-container">
                      <div class="astro-message-icon">ğŸŒŸ</div>
                      <h3 class="astro-heading">Message du Jour</h3>
                      <p class="astro-message" id="astro-message-text">{{ daily_message }}</p>
                    </div>
                </div>

                <div id="dream-content" class="glass-card" style="display:none;">
                    <div class="process-icon">âœ¨</div>
                    <h3 class="process-title">Votre RÃªve VisualisÃ©</h3>
                    <p class="process-description">Voici l'interprÃ©tation artistique de votre rÃ©cit.</p>

                    {% if dream.generated_image %}
                    <div class="mt-4 shadow rounded p-2" style="background: rgba(0,0,0,0.2);">
                        <img src="{{ dream.generated_image.url }}" class="img-fluid rounded" alt="Image gÃ©nÃ©rÃ©e du rÃªve">
                    </div>
                    {% endif %}

                    <div class="text-start mt-4">
                        <p><strong>Ã‰motion dominante :</strong><br><em class="opacity-75">{{ dream.get_emotion_display }}</em></p>
                        <p><strong>Transcription :</strong><br><em class="opacity-75">"{{ dream.transcription }}"</em></p>
                        <p><strong>Prompt utilisÃ© :</strong><br><em class="opacity-75">"{{ dream.image_prompt }}"</em></p>
                    </div>

                    <div class="astro-message-container mt-5">
                      <div class="astro-message-icon">ğŸŒŸ</div>
                      <h3 class="astro-heading">Message du Jour</h3>
                      <p class="astro-message">{{ daily_message }}</p>
                    </div>

                    <hr class="my-4" style="border-color: rgba(255,255,255,0.2);">
                    <div class="d-flex justify-content-center gap-2">
                        <a href="{% url 'dream_bridge_app:narrate' %}" class="btn btn-outline-light">Raconter un autre rÃªve</a>
                    </div>
                    
                </div>

            </div>
        </div>
    </div>
</main>
{% endblock %}

{% block scripts %}
<script src="{% static 'dream_bridge_app/waiting_screen.js' %}"></script>
{% endblock %}
